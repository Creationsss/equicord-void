# Template file for 'equibop'
pkgname=equibop
version=3.1.9
revision=1
_electronver=35
hostmakedepends="gcc nodejs nodejs-devel python3 pkg-config libglib-devel"
depends="electron${_electronver} hicolor-icon-theme desktop-file-utils"
short_desc="Custom Discord App for better performance and improved Linux support"
maintainer="creations <creations@creations.works>"
license="GPL-3.0-or-later"
homepage="https://github.com/Equicord/Equibop"
distfiles="https://github.com/Equicord/Equibop/archive/refs/tags/v${version}.tar.gz"
checksum=e344946af86a85c60bc4e7cc9efbfc3ac3fee7c41634bce1744bb41a6c0b469f
wrksrc="Equibop-${version}"
nostrip=yes

do_build() {
	export SKIP_BUN_DOWNLOAD=true
	export npm_config_nodedir=/usr
	CI=true bun install
	bun run buildLibVesktop
	bun run package:dir
}

do_install() {
	vmkdir usr/lib/equibop
	vinstall dist/linux-unpacked/resources/app.asar 644 usr/lib/equibop
	vinstall dist/linux-unpacked/resources/app-update.yml 644 usr/lib/equibop
	vcopy dist/linux-unpacked/resources/arrpc usr/lib/equibop

	vbin ${FILESDIR}/equibop.sh equibop

	vinstall ${FILESDIR}/equibop.desktop 644 usr/share/applications
	vinstall static/icon.png 644 usr/share/pixmaps equibop.png
	vinstall build/icon.svg 644 usr/share/icons/hicolor/scalable/apps equibop.svg
	vlicense LICENSE
}
